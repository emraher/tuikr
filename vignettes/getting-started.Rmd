---
title: "Getting Started with tuikr"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting Started with tuikr}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  eval = TRUE
)
```

## Introduction

`tuikr` provides access to Turkish Statistical Institute (TUIK) data from two portals:

1. **Main portal** ([data.tuik.gov.tr](https://data.tuik.gov.tr/)): Statistical themes, tables, and databases
2. **Geographic portal** ([cip.tuik.gov.tr](https://cip.tuik.gov.tr/)): Spatial data and maps

## Installation

Install the development version from GitHub:

```{r install, eval=FALSE}
# install.packages("devtools")
devtools::install_github("emraher/tuikr")
```

Load the package:

```{r setup}
library(tuikr)
library(tidyverse)
```

## Statistical Data Workflow

### Step 1: Discover Themes

TUIK organizes data into 17 thematic categories. Start by listing all available themes:

```{r themes}
(themes <- statistical_themes())
```

Returns a tibble with theme names (Turkish) and IDs.

### Step 2: Find Tables

Retrieve data tables for a theme:

```{r tables}
# Get tables for Justice and Elections theme
justice_tables <- statistical_tables("110")

# View the first few tables
head(justice_tables)
```

The function validates input:

```{r validate, error=TRUE, eval=FALSE}
# Invalid theme ID
statistical_tables("aaa")
#> Error in check_theme_id(theme) : You should select a valid theme ID!
```

```{r validate2, error=TRUE, eval=FALSE}
# Multiple themes not allowed
statistical_tables(c("110", "108"))
#> Error in check_theme_id(theme) : You can select only one theme!
```

### Step 3: Get Database URLs

Retrieve database URLs:

```{r databases}
justice_dbs <- statistical_databases("110")
```


## Downloading Data Files

Download Excel files using the URLs:

```{r download}
# Download a specific file
download.file(
  justice_tables$datafile_url[1],
  destfile = "/tmp/tuik_data.xls",
  mode = "wb"
)

# Read into R
library(readxl)
data <- read_xls("/tmp/tuik_data.xls")
```

TUIK Excel files often need cleaning: multiple headers, footer notes, mixed languages. Use `skip`, `n_max`, and `janitor::clean_names()`.

## Troubleshooting

### Network Issues

Check TUIK portal accessibility. See [Issue #2](https://github.com/emraher/tuikr/issues/2) for known connection problems.

### Website Structure Changes

TUIK website updates can break scraping. Check for package updates and report issues on [GitHub](https://github.com/emraher/tuikr/issues).

### Excel File Problems

Try `readxl::read_excel()`, use `skip` and `n_max` parameters, or inspect files manually.
